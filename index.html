---
layout: default
title: FENG LING（凌峰）
---

<div id="about" class="container col-md-11">
        <div class="row">
                <div class="container col-md-11">
                        <h2 id="h-about">About Me</h2>
                        <div id="lang-switch" style="float:right; margin-top:-28px; font-size:0.95em;">
                                <a href="#" id="lang-en">English</a> | <a href="#" id="lang-zh">中文</a>
                        </div>
                </div>
        </div>
	<div class="row">
                <div class="container col-md-3 col-lg-2">
                        <div class="profile-and-presence">
                                <div class="thumbnail profile-thumbnail">
                                        <!-- https://www.facebook.com/FengGotFangs -->
                                        <a href="https://www.linkedin.com/in/levincoolxyz" id="facelogo" class="profile-link" aria-label="Facebook profile">
                                                <img class="image-default" src="/images/astro-catch.jpg" alt="Illustration of Feng catching stars" />
                                                <img class="image-hover" src="/fotos/IMG_9802_3.jpg" alt="Portrait of Feng Ling" />
                                        </a>
                                </div>
                                <div class="presence-side">
                                        <h3 id="h-online">Online Presence</h3>
                                        <ul class="online-presence">
                                <li>
                                        <a class="presence-link presence-link-google-scholar" href="https://scholar.google.com/citations?user=nTfZSioAAAAJ&amp;hl=en" target="_blank" rel="noopener">
                                                <span class="presence-icon" aria-hidden="true"></span>
                                                <span class="presence-text">Google Scholar</span>
                                        </a>
                                </li>
                                <!-- <li>
                                        <a class="presence-link presence-link-linkedin" href="https://www.linkedin.com/in/feng-ling-97024834" target="_blank" rel="noopener">
                                                <span class="presence-icon" aria-hidden="true">in</span>
                                                <span class="presence-text">LinkedIn</span>
                                        </a>
                                </li> -->
                                <li>
                                        <a class="presence-link presence-link-slides" href="https://slides.com/levincoolxyz/" target="_blank" rel="noopener">
                                                <span class="presence-icon" aria-hidden="true"></span>
                                                <span class="presence-text">Slides.com</span>
                                        </a>
                                </li>
                                <li>
                                        <a class="presence-link presence-link-youtube" href="https://www.youtube.com/channel/UCvJmIb_B3vBrF4Da1P74ejQ" target="_blank" rel="noopener">
                                                <span class="presence-icon" aria-hidden="true"></span>
                                                <span class="presence-text">YouTube</span>
                                        </a>
                                </li>
                                <!-- <li>
                                        <a class="presence-link presence-link-instructables" href="http://www.instructables.com/member/fling?show=GOOD" target="_blank" rel="noopener">
                                                <span class="presence-icon" aria-hidden="true">I</span>
                                                <span class="presence-text">Instructables</span>
                                        </a>
                                </li> -->
                                <!-- <li>
                                        <a class="presence-link presence-link-thingiverse" href="https://www.thingiverse.com/levincoolxyz/about" target="_blank" rel="noopener">
                                                <span class="presence-icon" aria-hidden="true">T</span>
                                                <span class="presence-text">Thingiverse</span>
                                        </a>
                                </li> -->
                                <li>
                                        <a class="presence-link presence-link-github" href="https://github.com/levincoolxyz" target="_blank" rel="noopener">
                                                <span class="presence-icon" aria-hidden="true"></span>
                                                <span class="presence-text">GitHub</span>
                                        </a>
                                </li>
                                <li>
                                        <a class="presence-link presence-link-movie" href="https://www.themoviedb.org/u/levincoolxyz" target="_blank" rel="noopener">
                                                <span class="presence-icon" aria-hidden="true"></span>
                                                <span class="presence-text">TMDB</span>
                                        </a>
                                </li>
                                <!-- <li>
                                        <a class="presence-link presence-link-newgrounds" href="http://levincoolxyz.newgrounds.com/" target="_blank" rel="noopener">
                                                <span class="presence-icon" aria-hidden="true">Ng</span>
                                                <span class="presence-text">Newgrounds</span>
                                        </a>
                                </li> -->
                                        </ul>
                                </div>
                        </div>
                </div>
                <div class="container col-md-9 col-lg-10">

                        <p id="cv-container"><a id="cv-link" href="/cv/Ling,Feng - cv.pdf"><strong id="cv-label">CV</strong><span id="cv-updated"> (updated 2025/03/20)</span></a></p>

                        <p id="p-intro-1">I spend most of my time thinking about <span title="such as why do I need to get up, how to get up quickly, how to get into the work mood after getting up, why the heck do I need to sleep again after finding the mojo...">how living systems organize themselves</span>, how <strong>motion</strong>, <strong>form</strong>, and <strong>function</strong> fold into <em>dynamic loops</em> that make biological physics ever so slightly more magical than partial differential equations in a book. My current focus is on <a href="/cilia_bundle_visualizer.html">cilia</a>, the micrometer-scale, hair-like cellular appendages that line our <a href="/ciliary_clearance_visualizer.html">airways</a>, reproductive tracts, and even brain ventricles. Amazingly, not only is each cilium powered by <em>thousands of dynein motors</em>, but <em>millions</em> of copies of cilia can also coordinate to fulfill macroscopic flow functions crucial to many ways of life -- from <a href="https://micromotility.com/research/" target="_blank" rel="noopener">single-cell protists to algae colonies</a>, <a href="https://www.nature.com/articles/456334b">larvae</a> and <a href="https://www.cell.com/cell/fulltext/S0092-8674(00)81705-5">embryos</a>, <a href="https://www.nature.com/articles/s41567-024-02591-0">wide variety of animals</a>, and <a href="https://www.nature.com/articles/s41467-025-57667-z">us human beings</a>. These filamentous structures are also great inspirations for <a href="https://www.nature.com/articles/s41586-022-04645-w">artificial micro-manipulators</a>.</p>

                        <p id="p-intro-2">My broader goal is to understand how <a href="/dipole_school_visualizer.html"><strong>local interactions</strong></a> produce <strong>effective</strong> group laws, how the 
                        collective dynamics pushes <strong>meso/macro-scale physics back</strong> onto the active constituent units, and the causal emergence of coordination. I approach this through the lens of <strong>coarse-grained modeling, mechanical instabilities, multi-stabilities, and reinforcement learning techniques</strong>. As I gradually expanded from theory into microscopy and some wet lab experiments, I hope one day I will fulfill my own academic <a href="https://www.youtube.com/watch?v=wfRFjvJuh-k">"hierarchical cycle"</a> <a href="https://ahlouie.com/wp-content/uploads/2015/09/louiep-hierarchical-cycles-2011.pdf">(but seriously)</a> and build a consistent understanding of living active matter.</p>

                        <p id="p-intro-3">Outside the lab, I like to make <a href="/synchronizedSynthesis.html">quirky</a> music <a href="https://www.expressivee.com/2-osmose" target="_blank" rel="noopener">(isn't this thing amazing)</a> while enjoying the <a href="https://www.youtube.com/watch?v=QMhehfPvKf0">classics</a>, slow-mo everything (<a href="https://youtu.be/1JQX3kwhnGA">humming bird</a> on phantom) and photograph with maximum unseriousness (contrary to <a href="https://www.mbartonphotography.com/">these beauties</a>), jam body parts into cracks <a href="https://www.youtube.com/@WideBoyz" target="_blank" rel="noopener">(I'm talking about bouldering, yo)</a>, and think about <a href="https://ajblumberg.github.io/publications/" target="_blank" rel="noopener">geometry and topology</a>, <a href="https://www.cs.cmu.edu/~kmcrane/" target="_blank" rel="noopener">computer graphics</a>, <a href="https://radionavlab.ae.utexas.edu/">space related stuff</a> (yes, I <a href="https://www.thingiverse.com/levincoolxyz/about">built rockets</a> that flew too close to the crowd before) and <a href="https://www.grown.bio/">sustainability technologies</a>. I am especially drawn to see how similar ideas of emergent structures and constraints shape the complexity of our everyday world.</p>

                        <p id="p-bio">Currently I am a professor at <a href="https://physics.nankai.edu.cn/lf1/main.psp">Nankai Physics</a>. Previously I was a postdoctoral researcher in <a href="https://www.helmholtz-munich.de/en/research/helmholtz-pioneer-campus/hpc-research/janna-nawroth-lab">Dr. Janna Nawroth</a>'s Group at Helmholtz Pioneer Campus in Munich, Germany. I completed my fluid mechanics PhD following <a href="https://sites.usc.edu/kansolab/">Prof. Eva Kanso at USC</a>. I studied both pure mathematics and astronautical engineering at UT Austin, where I also worked as a student research assistant at Center for Space Research.</p>

                        <p><a id="h-other" data-toggle="collapse" data-target="#moreinfo" class="btn" style="color:rgb(250,0,100) !important;">click here for random babbles before 2017 with new edits in \[.*\]</a></p>
                        <div id="moreinfo" class="collapse">
                        <h4>Background photo</h4>
                        <p>The <a href="/fotos/duoduo.jpg">cutie</a> on the right <s>is</s>[was] my adopted sister 多多, who <s>is still living</s>[sadly passed away with loved ones caring till the end in 2024] at my hometown,
                        the <a href="http://ppcdn.500px.org/94138531/21b07ff790aadd89aeea7080fefb71163d93c0d1/2048.jpg">breathtakingly magnificent</a> <span title="literally, the yellow mountains">
                        <a href="https://en.wikipedia.org/wiki/Huangshan">黄山</a></span>.</p>
                        <h4>Reading</h4>
                        <p>Among my favourite books are <a href="http://www.amazon.com/gp/product/0691118809/ref=oh_aui_detailpage_o01_s01?ie=UTF8&psc=1">the Princeton Companion to Mathematics</a>,
                        <a href="http://www.amazon.com/gp/product/048668735X/ref=oh_aui_detailpage_o01_s00?ie=UTF8&psc=1">Counterexamples in Topology</a>,
                        <a href="http://www.amazon.com/gp/product/0486650677/ref=oh_aui_detailpage_o07_s00?ie=UTF8&psc=1">the Variational Principles of Mechanics</a>, many more Dover (re)publications and other classics,
                        such as things listed <a href="http://www.math.cornell.edu/~hatcher/Other/topologybooks.pdf">here</a> and at the end of May's A Concise Course in Algebraic Topology. Just go buy (me) something from
                        my (old) <a href="http://www.amazon.com/gp/registry/wishlist/3K3FPYEL6YQYP/ref=topnav_lists_1">Amazon wishlist</a> :P</p>
                        <p>And behold another <a href="http://arminstraub.com/math/what-is-column">set of gems</a> of mathematical exposition.</p>
                        <!-- looks like somebody screwed up
                        <p>And apparently "old" <a href="http://link.springer.com/search?facet-series=%22136%22&facet-content-type=%22Book%22&showAll=false">springer GTM books</a> are for free online!</p>
                        -->
                        <p>Maths aside, I find the <s><em>Road to Serfdom</em></s>[not that I agreed with the thesis at the time of writing. The double standard there is rather astounishing.
                        <a href="https://www.marxists.org/chinese/maozedong/marxist.org-chinese-mao-193708.htm">This</a>, among others, is much more insightful for life.], Crosby's <em>Ecological Imperialism</em>, and
                        <em>the Massacre at El Mozote</em> to be good reads. I also love lots of Chinese classics from <a href="http://book.douban.com/subject/1519026/">说文解字</a>, an ancient treatise documenting
                        <a href="http://www.chineseetymology.org/">Chinese Etymology</a> and things like 论语, to <a href="http://wx.ty2016.net/writer/jinyong.html">金庸的武侠</a>, famous 20<sup>th</sup> century martial art fantasies...
                        And I am in the process of digesting some works of 林语堂 [Yeah that never finished...].</p>
                        <p>And now an <a href="http://www.stilldrinking.org/programming-sucks">essay</a> about programming [and don't forget the classic <a href="https://www.destroyallsoftware.com/talks/wat">wat</a>].</p>
                        <h4>Music</h4>
                        <p>I play the piano (was a bit out of practice) [but can you imagine I attempted to pull off
                        <a href="https://www.hunliji.com/p/frontend/creation-platform/app-preview-wedding-card/dist/index.html?cardId=MTEyNzg0NDM2ZmlyZV9jbG91ZA">playing our song</a> at the wedding :))] and recently
                        picked up some guitar action [yeah still can't just play more than 80% of any tune].</p>
                        <p>Liszt, Rachmaninoff, and Bach are probably my most cherished composers. I love passion in the classical scales but also value precision, dignity, and complexity. 
                        My favourite pieces from them are Rhapsodie Espagnole, Liebestraum No.3, Consolation No.3, Hungarian Rhapsodies, and Rachmaninoff Piano Concertos, Prelude op.23 No.5, and the rhapsody. 
                        (It's pretty hard to pick favorites from Bach so I'm just gonna say Violin Partita No.2 plus all the fugues and inventions.) Beethoven's Symphony No.7 2nd mov., 
                        Etudes 'Revolutionary' of Chopin, Prokofiev's Piano Concerto op.26 No.3 1st mov., Bartok's Piano Concerto No.2 3rd mov. are also on my permanent playlist. 
                        My old <a href="https://www.linkedin.com/in/dawson-baker-a7a1103b">flatmate</a>(s) also forever made an impression of <a href="http://techno.org/electronic-music-guide/">House/Techno/EDM</a> vibe into 
                        <a href="https://bandcamp.com/levincoolxyz#wishlist">my musical tastes</a> [why can't I be as cool as <a href="https://www.instagram.com/ariatinsta/?hl=en">ARIatHOME</a>? D':].</p>
                        <h4 >Other Stuff</h4>
                        <!-- <p id="p-151">I enjoy lifting weights [esp. olympic style for maximum dynamic finesse] and <a href="http://www.exrx.net/Lists/Directory.html">here</a> is a pretty great resource.</p> -->
                        <p id="p-152">You can also read all about my thoughts on some shows and pictures for the past few years [ah... the college years and the free time ... no haven't update that in a while] or so <a href="/movrev">here</a>. There is some amateur photography <a href="/fotos">here</a> as well.</p>
                        <p id="p-153"><a href="https://www.scienceathome.org/games/quantum-moves/game">Here's a fun way</a> to get some <a href="https://terrytao.wordpress.com/career-advice/there%E2%80%99s-more-to-mathematics-than-rigour-and-proofs/">intuition</a> on 1D quantum dynamics.</p>
                        <p id="p-154">If you have never heard of <a href="https://www.shapeways.com/designer/oskar_van_deventer">Oskar van Deventer</a>, you should certainly check out <a href="https://www.youtube.com/user/OskarPuzzle">his YouTube channel of puzzles</a>.</p>
                        <p id="p-155">And speaking of YouTubers, go watch something from Brady's <a href="http://www.numberphile.com/">NumberPhile</a> and <a href="https://www.youtube.com/channel/UCtwKon9qMt5YLVgQt1tvJKg">Objectivity</a> channels and other math stuff from <a href="https://www.youtube.com/channel/UCYO_jab_esuFRV4b17AJtAw">3blue1brown</a>. A full collection of my favourite YouTuber can be found <a href="/collection">here</a>.
                         <!-- <a href="https://www.youtube.com/user/PulitzerCenter">The Pulitzer Center</a> also put up some videos that deserve more views than it has [wow I was that pretentious was I haha]. -->
                        </p>
                        <p id="p-157">Tinkering, manufacturing (the engineering guy has <a href="https://www.youtube.com/watch?v=RMjtmsr3CqA">an awesome video on injection molding</a>), and rapid prototyping (additive mfg., laser techs, and good ol' CNC) have always fascinated me I also love open source anything, from <a href="http://www.sagemath.org/">SageMath</a> to <a href="http://www.openscad.org/">openSCAD</a> [still my fav] to farming (<a href="http://opensourceecology.org/">open source ecology</a>).</p>
                        <p id="p-160">I've been occasionally using and contributing to) <a href="http://forvo.com/">Forvo</a> for awhile now [I would now invite you to join RedNote to get authentic dialects of all kinds from the source].</p>
                        <p id="p-161">This <a href="http://google-calendar-hours.com/">Google calendar hours calculator</a> comes in handy at times. So has this <a href="http://youcanbook.me">scheduling tool</a> if you are a fellow Google calendar junkie like me.</p>
                        <p id="p-162">I have also been learning French and German (mostly) through <a href="http://duolingo.com">Duolingo</a> for some time now. [And the skills just go downhill the longer my streak goes Ahhhhhha!] <a href="http://ielanguages.com/">ielanguages</a>
                         also have some pretty cool lessons (esp. on French pronunciation for me).</p>
                        <p>And why does paper warp dried after getting wet? <a href="https://www.reddit.com/r/askscience/comments/1lg3wx/why_does_paper_feel_different_after_it_has_been/">Reddit</a> comes to the rescue.</p>
                        <p id="p-165">Ig-noble prizes! <a href="https://lirias.kuleuven.be/bitstream/123456789/282526/3/MO_1007.pdf">This</a> is still my fav. What about hunger?.</p>
                        <p id="p-166"><a href="http://www.tunefind.com/">Tune find</a>, <a href="http://www.imsdb.com/">IMSDb</a>[oh man, feel so old to be there when IMDB was an active forum.], <a href="http://www.coinflation.com/">CoInflation</a>, and <a href="http://phdstipends.com">PHD stipends</a>
                         are some cool online databases.</p>
                        <p id="p-168">Have you ever heard of <a href="http://www.mushroomexpert.com/phallus_impudicus.html">the common stinkhorn</a>?</p>
                        <!--<p>And I have an obsession with making MetalEarth models.</p>-->
                        <p id="p-170">Finally a few <a href="quotes.html">quotes</a> I like.</p>
                </div>
                </div>
        </div>
</div>

<style>
/* Optional subtle emphasis for active language */
#lang-switch a { text-decoration: none; }
#lang-switch a.active { font-weight: bold; text-decoration: underline; }

/* Responsive: place online presence to the side of avatar on narrow screens */
@media (max-width: 991px) {
  .profile-and-presence { display: flex; gap: 12px; align-items: flex-start; }
  .profile-and-presence .profile-thumbnail { flex: 0 0 auto; max-width: 180px; width: 40%; }
  .profile-and-presence .profile-thumbnail img { width: 100%; height: auto; }
  .profile-and-presence .presence-side { flex: 1 1 0; min-width: 0; }
  .profile-and-presence .presence-side h3 { margin-top: 0; }
}

/* Fall back to default stacking on md+ */
@media (min-width: 992px) {
  .profile-and-presence { display: block; }
}
</style>

<script>
(function() {
  // Chinese translations for targeted elements (innerHTML preserved for EN)
  const zh = {
    'header-top': '<a href="/"><h1>凌峰</h1></a>',
    'hometab': '<a href="/">首页</a>',
    'cvtab': '<a href="/cv">作品</a>',
    'moretab': '其他 <b class="caret"></b>',
    'collectab': '秋收冬藏',
    'filmtab': '影评（久无更新）',
    'fototab': '摄影（久无更新）',
    'blogtab': '博客（已弃）',
    'h-about': '个人信息',
    'h-online': '网络寻踪',
    'p-intro-1': `清醒时我通常都在与<span title="比如为什么要起床、怎么快速起床、起床如何加入社会化大生产、好不容易产出节奏了为啥还得睡觉">生物系统的自组织现象</span>较真。我所感兴趣的科学问题基本都可以算作“因果涌现”等这类<a href="https://swarma.org/">复杂科学</a>与<a href="https://slides.com/levincoolxyz/activematter">活性物质</a>研究的一部分。具体工作一般从<strong>粗粒化建模、强化学习、力学不稳定性与多稳态分析</strong>、及相应的实验验证开展。目前研究的主要对象是真核细胞的<a href="/cilia_bundle_visualizer.html">运动纤毛</a>，一种常见于<a href="/ciliary_clearance_visualizer.html">呼吸道</a>、生殖系统、以及脑脊液腔室等上皮细胞组织的微米级、毛发状的细胞器。每根纤毛的摆动需要依赖上千组的动力蛋白马达的协调运作，聚集起来的纤毛还能够相互协同以实现宏观器官层级的液体泵送功能。这些功能对<a href="https://micromotility.com/research/" target="_blank" rel="noopener">单细胞生物和群体的运动与迁移</a>、许多<a href="https://www.nature.com/articles/456334b">幼虫</a>和<a href="https://www.cell.com/cell/fulltext/S0092-8674(00)81705-5">胚胎</a>的发育、<a href="https://www.nature.com/articles/s41567-024-02591-0">各种各样的海洋与陆上动物</a>乃至<a href="https://www.nature.com/articles/s41467-025-57667-z">我们人类本体</a>的健康与生长十分重要。这类丝状结构也可以为人类设计各种微操手段<a href="https://www.nature.com/articles/s41586-022-04645-w">（如微流控）</a>提供灵感。`,
    'p-intro-2': `生命物质的自组织与涌现当然不仅仅局限于由纤毛摆动而加速的细胞功能；群体细胞间及其与细胞外基质的互作用力、马达蛋白驱动的细胞骨架运动等等内驱力也可触发多种值得深究的<strong>群体细胞协同迁移现象</strong>。超越中微观层级，广为人知的<a href="/dipole_school_visualizer.html">鱼群</a>与鸟群协同等宏观与跨尺度自组织现象也还有许多未解之谜：<strong>局部相互作用</strong>到底在什么情况下能涌现成<strong>有效的</strong>群体规律；高层级群体的动态演化又如何把<strong>介观和宏观物理</strong>反馈到每个个体？如果你对这类<a href="https://ahlouie.com/wp-content/uploads/2015/09/louiep-hierarchical-cycles-2011.pdf">“多层级循环”</a>等问题感兴趣，欢迎一起讨论。`,
    'p-intro-3': `科研之外，我喜欢音乐（从<a href="https://www.bachvereniging.nl/en/allofbach">巴赫</a>、<a href="https://www.bilibili.com/video/av43381008/">古琴</a>、<a href="/synchronizedSynthesis.html">奇奇怪怪</a>到<a href="https://www.expressivee.com/2-osmose">新技术</a>)，喜欢包括慢镜头在内（用Phantom采集到的<a href="https://youtu.be/1JQX3kwhnGA">蜂鸟降落</a>）等各类抽象摄影；传统美图请移步<a href="https://www.mbartonphotography.com/">这里</a>。我还是<a href="https://wideboyz.com/" target="_blank" rel="noopener">攀岩/抱石/卡缝</a>迷。不想干“正事”时候会去欣赏<a href="https://ajblumberg.github.io/publications/" target="_blank" rel="noopener">拓扑</a>、<a href="https://www.cs.cmu.edu/~kmcrane/" target="_blank" rel="noopener">计算几何</a>、<a href="https://radionavlab.ae.utexas.edu/">航天</a>（曾几一时俺也打磨过劣质<a href="https://www.thingiverse.com/levincoolxyz/about">火箭</a>）与<a href="https://www.grown.bio/">可持续发展类技术</a>。`,
    'p-bio': `我是<a href="https://physics.nankai.edu.cn/lf1/main.psp">南开大学物理科学学院</a>生命信息物理学教授。我的博后合作导师是德国慕尼黑亥姆霍兹研究所的<a href="https://www.helmholtz-munich.de/en/research/helmholtz-pioneer-campus/hpc-research/janna-nawroth-lab"> Janna Nawroth 博士</a>。我是在南加大<a href="https://sites.usc.edu/kansolab/"> Eva Kanso 教授</a>指导下完成的流体力学博士学习。我本科在德州大学奥斯汀分校主修纯数学与航天工程，曾在空间研究中心任科研助理。`,
    'h-other': '后面还有n年前写的各种，一直鲜有更新。想看直接机翻吧（手动狗头）',
  };

  function setActiveLink(lang) {
    var en = document.getElementById('lang-en');
    var zhLink = document.getElementById('lang-zh');
    if (en && zhLink) {
      en.classList.toggle('active', lang === 'en');
      zhLink.classList.toggle('active', lang === 'zh');
    }
  }

  function setLang(lang) {
    document.documentElement.classList.toggle('lang-zh', lang === 'zh');
    document.documentElement.classList.toggle('lang-en', lang !== 'zh');
    try { localStorage.setItem('lang', lang); } catch(e) {}

    // Update CV link and label
    var cvLink = document.getElementById('cv-link');
    var cvLabel = document.getElementById('cv-label');
    var cvUpdated = document.getElementById('cv-updated');
    if (cvLink && cvLabel && cvUpdated) {
      if (lang === 'zh') {
        cvLink.setAttribute('href', '/cv/凌峰简历(中文).pdf');
        cvLabel.textContent = '简历';
        cvUpdated.textContent = '（更新于 2025/03/20）';
      } else {
        cvLink.setAttribute('href', '/cv/Ling,Feng - cv.pdf');
        cvLabel.textContent = 'CV';
        cvUpdated.textContent = ' (updated 2025/03/20)';
      }
    }

    // Update translations
    Object.keys(zh).forEach(function(id) {
      var el = document.getElementById(id);
      if (!el) return;
      if (!el.dataset.en) { el.dataset.en = el.innerHTML; }
      el.innerHTML = (lang === 'zh') ? zh[id] : el.dataset.en;
    });

    setActiveLink(lang);

    // Re-attach tooltips after content swap
    if (window.setupTapTooltips) {
      try { window.setupTapTooltips(document); } catch (e) {}
    } else if (window.initMobileTooltips) {
      try { window.initMobileTooltips(document); } catch (e) {}
    }
  }

  document.addEventListener('DOMContentLoaded', function() {
    var stored = 'en';
    try { stored = localStorage.getItem('lang') || 'en'; } catch(e) {}
    setLang(stored);
    var en = document.getElementById('lang-en');
    var zhLink = document.getElementById('lang-zh');
    if (en) en.addEventListener('click', function(e){ e.preventDefault(); setLang('en'); });
    if (zhLink) zhLink.addEventListener('click', function(e){ e.preventDefault(); setLang('zh'); });

    // Initial tooltip setup
    if (window.setupTapTooltips) {
      try { window.setupTapTooltips(document); } catch (e) {}
    } else if (window.initMobileTooltips) {
      try { window.initMobileTooltips(document); } catch (e) {}
    }
  });
})();
</script>

<style>
/* Tap-friendly tooltip bubble */
.tap-tooltip { cursor: help; }
.tooltip-pop {
  position: fixed;
  background: rgba(0,0,0,0.9);
  color: #fff;
  padding: 8px 10px;
  border-radius: 8px;
  font-size: 0.92em;
  line-height: 1.25;
  max-width: min(320px, 92vw);
  z-index: 9999;
  box-shadow: 0 10px 24px rgba(0,0,0,0.35);
}
.tooltip-pop::after {
  content: '';
  position: absolute;
  left: 50%;
  transform: translateX(-50%);
  bottom: -8px;
  border: 8px solid transparent;
  border-top-color: rgba(0,0,0,0.9);
}
</style>

<script>
// Robust, cross-browser tap/hover tooltips sourced from data-tooltip/title
(function(){
  var bubble, currentTarget = null;

  function ensureBubble(){
    if (!bubble){
      bubble = document.createElement('div');
      bubble.className = 'tooltip-pop';
      bubble.id = 'tooltip-pop';
      bubble.setAttribute('role','tooltip');
      bubble.style.display = 'none';
      document.body.appendChild(bubble);
    }
    return bubble;
  }

  function getTooltipText(el){
    return el.getAttribute('data-tooltip') || el.getAttribute('title') || '';
  }

  function enhance(el){
    if (!el) return;
    var txt = getTooltipText(el);
    if (!txt) return;
    // Normalize storage to data-tooltip and remove native title to prevent duplicate bubbles
    if (!el.hasAttribute('data-tooltip')) el.setAttribute('data-tooltip', txt);
    if (el.hasAttribute('title')) el.removeAttribute('title');
    el.classList.add('tap-tooltip');
    // Make focusable if non-interactive
    var tag = (el.tagName || '').toLowerCase();
    var interactive = /^(a|button|input|textarea|select|summary)$/i.test(tag);
    if (!interactive && !el.hasAttribute('tabindex')) el.setAttribute('tabindex','0');
    el.setAttribute('aria-describedby','tooltip-pop');
  }

  function setupTapTooltips(root){
    root = root || document;
    var nodes = root.querySelectorAll('[title], [data-tooltip]');
    for (var i = 0; i < nodes.length; i++) enhance(nodes[i]);
  }
  window.setupTapTooltips = setupTapTooltips;
  // Back-compat alias
  window.initMobileTooltips = setupTapTooltips;

  function positionBubble(target){
    var b = ensureBubble();
    var rect = target.getBoundingClientRect();
    var vw = Math.max(document.documentElement.clientWidth, window.innerWidth || 0);
    var margin = 10;

    b.style.display = 'block';
    b.textContent = getTooltipText(target);
    b.style.left = '0px';
    b.style.top = '0px';
    // First layout to get bubble size
    var bw = b.offsetWidth;
    var bh = b.offsetHeight;

    // Center over target; clamp to viewport
    var cx = rect.left + rect.width/2;
    var left = Math.max(margin, Math.min(vw - margin - bw, cx - bw/2));
    var top = Math.max(margin, rect.top - bh - 12);
    b.style.left = left + 'px';
    b.style.top = top + 'px';
  }

  function hideBubble(){
    if (!bubble) return;
    bubble.style.display = 'none';
    currentTarget = null;
  }

  function showFor(target){
    if (!target) return;
    if (currentTarget === target) { hideBubble(); return; }
    currentTarget = target;
    positionBubble(target);
  }

  // Delegated interactions
  var supportsPointer = 'PointerEvent' in window;
  if (supportsPointer){
    document.addEventListener('pointerdown', function(e){
      var t = e.target.closest('.tap-tooltip');
      if (t) { e.preventDefault(); showFor(t); }
      else { hideBubble(); }
    }, true);
  } else {
    document.addEventListener('touchstart', function(e){
      var t = e.target.closest('.tap-tooltip');
      if (t) { e.preventDefault(); showFor(t); }
      else { hideBubble(); }
    }, { capture: true, passive: false });
    document.addEventListener('mousedown', function(e){
      var t = e.target.closest('.tap-tooltip');
      if (t) { e.preventDefault(); showFor(t); }
      else { hideBubble(); }
    }, true);
  }

  // Keyboard focus/escape
  document.addEventListener('focusin', function(e){
    var t = e.target.closest('.tap-tooltip');
    if (t) showFor(t);
  });
  document.addEventListener('focusout', function(e){
    var t = e.target.closest('.tap-tooltip');
    if (t && currentTarget === t) hideBubble();
  });
  document.addEventListener('keydown', function(e){
    if (e.key === 'Escape') hideBubble();
  });

  // Keep bubble anchored on scroll/resize when open
  function maybeReposition(){ if (currentTarget) positionBubble(currentTarget); }
  window.addEventListener('scroll', maybeReposition, true);
  window.addEventListener('resize', maybeReposition);

  document.addEventListener('DOMContentLoaded', function(){
    setupTapTooltips(document);
  });
})();
</script>
